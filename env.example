# Environment variables for docker-compose
# Copy this file to .env and update with your values

# RunPod configuration (required when RUN_ENV=runpod)
# RunPod serverless instance IDs (used by the ComfyUI RunPod client)
RUNPOD_IMAGE_INSTANCE_ID=your-actual-runpod-image-instance-id
RUNPOD_VIDEO_INSTANCE_ID=your-actual-runpod-video-instance-id
# RunPod API key used for authenticating requests to RunPod serverless
RUNPOD_API_KEY=your-runpod-api-key
# Base URL for ComfyUI API.
# For RunPod serverless this is typically https://api.runpod.ai
COMFYUI_URL=https://api.runpod.ai
# Execution environment selector for ComfyUI client factory.
# Supported values in this repo: local | runpod
RUN_ENV=runpod

# Other configuration
# Shared storage path used by the worker to write outputs (clips, stitched video, etc.)
DATA_SHARED_BASE=/data/shared
REDIS_URL=redis://redis:6379/2

# Feature flags
ENABLE_IMAGE_GEN=true
ENABLE_VOICEOVER_GEN=false

# Default image dimensions (used when request does not specify overrides)
IMAGE_WIDTH=480
IMAGE_HEIGHT=480

# Default ComfyUI/RunPod job polling settings (fallbacks).
# Most workflows now use the per-operation IMAGE_/VIDEO_*/UPSCALE_* settings below.
COMFYUI_TIMEOUT_SECONDS=600
COMFYUI_POLL_INTERVAL_SECONDS=5
LOG_LEVEL=INFO
UVICORN_LOG_LEVEL=info

# Webhook endpoints (N8N)
VIDEO_COMPLETED_N8N_WEBHOOK_URL=https://birthdaypartyai.app/n8n/webhook/07ec5d3d-59ed-4605-b655-fbb3579169cb
# For local deployment: http://n8n:5678/n8n/webhook/1f8c887d-0247-4378-b855-934f780bdb0c
N8N_PROMPTS_WEBHOOK_URL=http://n8n:5678/n8n/webhook/1f8c887d-0247-4378-b855-934f780bdb0c
N8N_VOICEOVER_WEBHOOK_URL=http://n8n:5678/webhook/96b6d82c-ee94-46aa-b38d-4c9e77d096b4

# Temporal server address (host:port)
TEMPORAL_SERVER_URL=temporal:7233

# HTTP timeout when waiting for N8N webhook responses (per request)
N8N_WEBHOOK_TIMEOUT_SECONDS=300

# Short-lived activity timeout for creating the run folder + writing the manifest
SETUP_RUN_DIRECTORY_TIMEOUT_SECONDS=5

# Shared "short" Temporal activity timeout used by several non-GPU activities
# (voiceover, stitch, subtitles, completion webhook)
ACTIVITY_SHORT_TIMEOUT_MINUTES=5

# Temporal activity timeouts (how long Temporal allows the activity to run)
GENERATE_SCENES_TIMEOUT_MINUTES=5
DEFAULT_ACTIVITY_TIMEOUT_MINUTES=15
STITCH_TIMEOUT_MINUTES=7
SUBTITLES_TIMEOUT_MINUTES=5

# Temporal activity timeouts for GPU-heavy operations (image/video generation + upscale)
TEMPORAL_IMAGE_GENERATION_TIMEOUT_MINUTES=15
TEMPORAL_VIDEO_GENERATION_TIMEOUT_MINUTES=15
TEMPORAL_UPSCALE_GENERATION_TIMEOUT_MINUTES=30

# RunPod HTTP request timeouts (per request)
# These control the underlying network calls (submit job, poll status, download outputs)
RUNPOD_IMAGE_HTTP_TIMEOUT_SECONDS=30
RUNPOD_VIDEO_HTTP_TIMEOUT_SECONDS=30
RUNPOD_VIDEO_OUTPUT_HTTP_TIMEOUT_SECONDS=120
RUNPOD_UPSCALE_HTTP_TIMEOUT_SECONDS=30

# RunPod/ComfyUI job polling settings (how long we wait for the job to finish)
# NOTE: These should be <= the corresponding TEMPORAL_*_TIMEOUT, otherwise Temporal may time out first.
IMAGE_JOB_TIMEOUT_SECONDS=600
IMAGE_POLL_INTERVAL_SECONDS=5
VIDEO_JOB_TIMEOUT_SECONDS=600
VIDEO_POLL_INTERVAL_SECONDS=5
UPSCALE_JOB_TIMEOUT_SECONDS=1800
UPSCALE_POLL_INTERVAL_SECONDS=5
